name: Shell Tests

on:
  push:
    branches: [ "**" ]
  pull_request:
    branches: [ "**" ]
  workflow_dispatch:

jobs:
  test:
    name: Run BATS Tests
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Setup BATS testing framework
      run: |
        chmod +x ./test/setup_bats.sh ./test/run_tests.sh
        ./test/setup_bats.sh

    - name: Run tests
      run: ./test/run_tests.sh --verbose

    - name: Test Summary
      if: always()
      run: |
        if [ ${{ job.status }} == 'success' ]; then
          echo "✅ All tests passed!"
        else
          echo "❌ Some tests failed"
          exit 1
        fi
